<form version="1.2" theme="dark">
  <label>Detailed Search Metrics Dashboard</label>
  <fieldset submitButton="true" autoRun="true">
    <input type="time" token="time" searchWhenChanged="false">
      <label>Time Range</label>
      <default>
        <earliest>-60m@m</earliest>
        <latest>@m</latest>
      </default>
    </input>
    <input type="text" token="filter_sh">
      <label>Filter Search Heads</label>
      <default></default>
    </input>
    <input type="text" token="filter_sched">
      <label>Filter Scheduled</label>
      <default></default>
    </input>
    <input type="text" token="filter_adhoc">
      <label>Filter Ad-Hoc</label>
      <default>search_id!="*subsearch*"</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1>NOTE: Average Search Concurrency is calculated properly only when explicit time range is selected!</h1>
            <h1>Search concurrency is the only correct metric to measure the search load on the system:</h1>
            <h1>Cs = ùù∫ * T</h1>
            <h2>Cs - concurrent searches or search concurrency</h2>
            <h2>ùù∫ - the average search arrival rate in searches per second = total searches / elapsed time in seconds</h2>
            <h2>T - the average search runtime in seconds = total search runtime / total searches</h2>
            <h1>Cs = Total Search Runtime / Elapsed Time in Seconds</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1/>
            <h1>Search Concurrency Stats</h1>
            <h2>NOTE: Stats for all searches, including canceled, failed, and incomplete searches.</h2>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Min Search Concurrency</title>
      <single>
        <search base="sc_stats">
          <query>
            | stats min(distinct_search_count) as min_search_concurrency
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <title>Median Search Concurrency</title>
      <single>
        <search base="sc_stats">
          <query>
            | stats median(distinct_search_count) as median_search_concurrency
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Concurrency</title>
      <single>
        <search base="sc_stats">
          <query>
            | stats p90(distinct_search_count) as p90_search_concurrency
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <title>P95 Search Concurrency</title>
      <single>
        <search base="sc_stats">
          <query>
            | stats p95(distinct_search_count) as p95_search_concurrency
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Concurrency</title>
      <single>
        <search base="sc_stats">
          <query>
            | stats max(distinct_search_count) as max_search_concurrency
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search base="sc_stats">
          <query>
            | stats avg(distinct_search_count) as avg_search_concurrency
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x116632","0x116632"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1>All Dashboard And Scripted Searches</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search>
          <query>
            index=_audit TERM(info=completed) TERM(action=search) savedsearch_name!="" $filter_sh$
            | where provenance!="scheduler" AND provenance!="N/A" AND provenance!="summary_director"
            | stats avg(total_run_time) as avg_runtime
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search>
          <query>
            index=_audit TERM(info=completed) TERM(action=search) savedsearch_name!="" $filter_sh$
            | where provenance!="scheduler" AND provenance!="N/A" AND provenance!="summary_director"
            | stats p90(total_run_time) as p90_runtime
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search>
          <query>
            index=_audit TERM(info=completed) TERM(action=search) savedsearch_name!="" $filter_sh$
            | where provenance!="scheduler" AND provenance!="N/A" AND provenance!="summary_director"
            | stats max(total_run_time) as max_runtime
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Count</title>
      <single>
        <search>
          <query>
            index=_audit TERM(info=completed) TERM(action=search) savedsearch_name!="" $filter_sh$
            | where provenance!="scheduler" AND provenance!="N/A" AND provenance!="summary_director"
            | stats dc(search_id) AS search_count
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search>
          <query>
            index=_audit TERM(info=completed) TERM(action=search) savedsearch_name!="" $filter_sh$
            | where provenance!="scheduler" AND provenance!="N/A" AND provenance!="summary_director"
            | stats dc(search) as unique_searches
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search>
          <query>
            index=_audit TERM(info=completed) TERM(action=search) savedsearch_name!="" $filter_sh$
            | where provenance!="scheduler" AND provenance!="N/A" AND provenance!="summary_director"
            | stats sum(total_run_time) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1>All Ad-Hoc Searches</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search base="adhoc_stats">
          <query>
            | stats avg(total_run_time) as avg_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search base="adhoc_stats">
          <query>
            | stats p90(total_run_time) as p90_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search base="adhoc_stats">
          <query>
            | stats max(total_run_time) as max_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Counts</title>
      <single>
        <search base="adhoc_stats">
          <query>
            | stats count as search_counts
            </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search base="adhoc_stats">
          <query>
            | stats dc(search) as unique_searches
            </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search base="adhoc_stats">
          <query>
            | stats sum(total_run_time) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1/>
            <h1>All Scheduled Searches</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search base="sched_stats">
          <query>
            | stats avg(run_time) as avg_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search base="sched_stats">
          <query>
            | stats p90(run_time) as p90_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search base="sched_stats">
          <query>
            | stats max(run_time) as max_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Counts</title>
      <single>
        <search base="sched_stats">
          <query>
            | stats count as search_counts
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search base="sched_stats">
          <query>
            | stats dc(savedsearch_name) as unique_searches
            </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search base="sched_stats">
          <query>
            | stats sum(run_time) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1/>
            <h1>DMA Searches</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search base="dma_stats">
          <query>
            | stats avg(run_time) as avg_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search base="dma_stats">
          <query>
            | stats p90(run_time) as p90_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search base="dma_stats">
          <query>
            | stats max(run_time) as max_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Counts</title>
      <single>
        <search base="dma_stats">
          <query>
            | stats count as search_counts
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search base="dma_stats">
          <query>
            | stats dc(savedsearch_name) as unique_searches
            </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search base="dma_stats">
          <query>
            | stats sum(run_time) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1/>
            <h1>ES Detections</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search base="es_corr_stats">
          <query>
            | stats avg(run_time) as avg_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search base="es_corr_stats">
          <query>
            | stats p90(run_time) as p90_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search base="es_corr_stats">
          <query>
            | stats max(run_time) as max_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Counts</title>
      <single>
        <search base="es_corr_stats">
          <query>
            | stats count as search_counts
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search base="es_corr_stats">
          <query>
            | stats dc(savedsearch_name) as unique_searches
            </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search base="es_corr_stats">
          <query>
            | stats sum(run_time) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1/>
            <h1>ESCU Detections</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search base="escu_stats">
          <query>
            | stats avg(run_time) as avg_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search base="escu_stats">
          <query>
            | stats p90(run_time) as p90_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search base="escu_stats">
          <query>
            | stats max(run_time) as max_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Counts</title>
      <single>
        <search base="escu_stats">
          <query>
            | stats count as search_counts
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search base="escu_stats">
          <query>
            | stats dc(savedsearch_name) as unique_searches
            </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search base="escu_stats">
          <query>
            | stats sum(run_time) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1/>
            <h1>Report Acceleration Searches</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search base="rep_stats">
          <query>
            | stats avg(run_time) as avg_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search base="rep_stats">
          <query>
            | stats p90(run_time) as p90_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search base="rep_stats">
          <query>
            | stats max(run_time) as max_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Counts</title>
      <single>
        <search base="rep_stats">
          <query>
            | stats count as search_counts
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search base="rep_stats">
          <query>
            | stats dc(savedsearch_name) as unique_searches
            </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search base="rep_stats">
          <query>
            | stats sum(run_time) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1/>
            <h1>Other Saved Searches</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search base="saved_stats">
          <query>
            | stats avg(run_time) as avg_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search base="saved_stats">
          <query>
            | stats p90(run_time) as p90_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search base="saved_stats">
          <query>
            | stats max(run_time) as max_runtime
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Counts</title>
      <single>
        <search base="saved_stats">
          <query>
            | stats count as search_counts
          </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search base="saved_stats">
          <query>
            | stats dc(savedsearch_name) as unique_searches
            </query>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search base="saved_stats">
          <query>
            | stats sum(run_time) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
          <div style="text-align: left;">
            <h1/>
            <h1>Summarization Searches</h1>
          </div>
        </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Average Search Runtime</title>
      <single>
        <search>
          <query>
            index=_access uri=*admin/summarization* $filter_sh$ $filter_sched$
            | eval spent_s=spent/1000
            | stats avg(spent_s) as avg_summarization_runtime
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x0055ff","0x0055ff"]</option>
        <option name="rangeValues">[1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>P90 Search Runtime</title>
      <single>
        <search>
          <query>
            index=_access uri=*admin/summarization* $filter_sh$ $filter_sched$
            | eval spent_s=spent/1000
            | stats p90(spent_s) as p90_summarization_runtime
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Max Search Runtime</title>
      <single>
        <search>
          <query>
            index=customer_access host=sh* uri=*admin/summarization* stack::$stack_name$ $filter_sh$ $filter_sched$
            | eval spent_s=spent/1000
            | stats max(spent_s) as max_summarization_runtime
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unit">s</option>
      </single>
    </panel>
    <panel>
      <title>Search Counts</title>
      <single>
        <search>
          <query>
            index=customer_access host=sh* uri=*admin/summarization* stack::$stack_name$ $filter_sh$ $filter_sched$
            | eval spent_s=spent/1000
            | stats count as search_counts
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xd41f1f","0xd41f1f"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Unique Searches</title>
      <single>
        <search>
          <query>
            index=customer_access host=sh* uri=*admin/summarization* stack::$stack_name$ $filter_sh$ $filter_sched$
            | eval spent_s=spent/1000
            | stats dc(uri) as unique_searches
            </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x663399","0x663399"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>Average Search Concurrency</title>
      <single>
        <search>
          <query>
            index=customer_access host=sh* uri=*admin/summarization* stack::$stack_name$ $filter_sh$ $filter_sched$
            | eval spent_s=spent/1000
            | stats sum(spent_s) as avg_search_concurrency
            | eval elapsed_time = $time.latest$ - $time.earliest$
            | eval avg_search_concurrency = round(avg_search_concurrency/elapsed_time, 2)
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x118832","0x118832"]</option>
        <option name="rangeValues">[100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="sc_stats">
          <query>
            | tstats dc(data.search_props.sid) AS distinct_search_count
              where index=_introspection
              sourcetype=splunk_resource_usage
              component=PerProcess
              data.search_props.role=head
              data.search_props.sid=*
              $filter_sh$ by _time span=10s
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="scripted">
          <query>
            index=_audit info=completed action=search $filter_sh$
            | where provenance!="scheduler" AND provenance!="N/A" AND provenance!="summary_director"
	          <!--index=customer_audit savedsearch_name TERM(info=completed) TERM(action=search) AND (host=sh*.splunk*.* OR host=si*.splunk*.*) stack::$stack_name$ $filter_sh$
            | where provenance!="scheduler" AND provenance!="N/A" AND provenance!="summary_director"-->
	        </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="adhoc_stats">
          <query>
            index=_audit TERM(action=search) TERM(info=completed) savedsearch_name="" $filter_sh$ $filter_adhoc$
            | eval run_time = 'total_run_time'
            | eval search = 'search'
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="sched_stats">
          <query>
            index=_internal TERM(status=success) savedsearch_name="*" $filter_sh$ $filter_sched$
            | eval runtime='run_time'
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="dma_stats">
          <query>
            index=_internal host=sh* TERM(status=success) savedsearch_name="_ACCELERATE_DM*" $filter_sh$ $filter_sched$
            | eval runtime='run_time'
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="es_corr_stats">
          <query>
            index=_internal TERM(status=success) savedsearch_name="*Rule" app!=DA-ESS-ContentUpdate $filter_sh$ $filter_sched$
            | eval runtime='run_time'
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="escu_stats">
          <query>
            index=_internal host=sh* TERM(status=success) savedsearch_name="*Rule" app=DA-ESS-ContentUpdate $filter_sh$ $filter_sched$
            | eval runtime='run_time'
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="rep_stats">
          <query>
            index=_internal TERM(status=success) savedsearch_name="_ACCELERATE*" savedsearch_name!="_ACCELERATE_DM*" $filter_sh$ $filter_sched$
            | eval runtime='run_time'
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$hide_me$">
        <search id="saved_stats">
          <query>
            index=_internal TERM(status=success) savedsearch_name!="_ACCELERATE*" savedsearch_name!="*Rule" $filter_sh$ $filter_sched$
            | eval runtime='run_time'
          </query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
</form>